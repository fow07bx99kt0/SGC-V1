<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SGC – Seção</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    :root { --bar-h: 48px; }
    .topbar {
      position: sticky; top: 0; left: 0; right: 0;
      height: var(--bar-h);
      display: flex; align-items: center; gap: 10px;
      padding: 0 12px;
      background: #fff; border-bottom: 1px solid #e5e7eb; z-index: 1000;
    }
    .topbar .logo { display:flex; align-items:center; gap:8px; font-weight:600; }
    .topbar .logo img { height: 24px; }
    .back-btn {
      display:inline-flex; align-items:center; gap:8px;
      padding: 8px 12px; border-radius: 10px; border: 1px solid #e5e7eb;
      background:#f9fafb; color:#111827; text-decoration:none; cursor:pointer;
    }
    .back-btn:hover { background:#f3f4f6; }
    .wrap { height: calc(100vh - var(--bar-h)); }
    .frame {
      width: 100%; height: 100%; border: 0;
      background: #fff;
    }
    .fallback {
      max-width: 980px; margin: 24px auto; padding: 24px;
      background:#fff; border:1px solid #e5e7eb; border-radius: 16px;
      text-align:center;
    }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="logo">
      <img src="https://raw.githubusercontent.com/leodutraui/assets/main/sgc/logo-sgc.png" alt="SGC" />
      <span>SGC</span>
    </div>
    <a class="back-btn" href="index.html" id="btnBack" title="Voltar para a tela inicial">← Voltar</a>
  </div>

  <div class="wrap">
    <iframe id="docFrame" class="frame" sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-downloads"></iframe>
  </div>

  <div id="fallback" class="fallback" style="display:none">
    <h2>Abrindo documentos da seção…</h2>
    <p>Se não abrir automaticamente, <a id="directLink" href="#">clique aqui</a>.</p>
    <p><a class="back-btn" href="index.html">← Voltar para a Home</a></p>
  </div>

  <script>
    const params = new URLSearchParams(location.search);
    const name = params.get('name') || 'Seção';
    const target = params.get('target');

    document.title = 'SGC — ' + name;

    const frame = document.getElementById('docFrame');
    const fallback = document.getElementById('fallback');
    const directLink = document.getElementById('directLink');

    if (target) {
      try {
        frame.src = target;
        directLink.href = target;
        // Se o site bloquear iframe, mostramos fallback e redirecionamos após um tempo
        let gaveUp = false;
        const timer = setTimeout(() => {
          gaveUp = true;
          fallback.style.display = 'block';
          // Redireciona como último recurso (abre na mesma guia)
          window.location.href = target;
        }, 1800);

        frame.addEventListener('load', () => {
          if (!gaveUp) {
            clearTimeout(timer);
            fallback.style.display = 'none';
          }
        });
      } catch (e) {
        // Fallback imediato
        window.location.href = target;
      }
    } else {
      fallback.style.display = 'block';
    }
  </script>
</body>
</html>
